<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- 검색어를 동적으로 타이틀에 포함 (수정: |...| 대신 + 연산자 사용) -->
  <title th:text="'\'' + ${query} + '\' 검색 결과'">검색 결과</title>

  <link rel="stylesheet" href="/css/search/search_styles.css">
  <link rel="stylesheet" href="/css/header/header.css">

</head>
<body>

<div th:replace="~{fragments/header :: headerFragment}"></div>

<main>
  <div class="main-container">
    <!-- 검색 결과 제목 (수정: |...| 대신 + 연산자 사용) -->
    <h2 class="search-title" th:text="'\'' + ${query} + '\' 검색 결과'">'제습기' 검색 결과</h2>

    <div class="item-grid" th:if="${!page.empty}">
      <!--
        [THYMELEAF 핵심]
        - page.content: Page 객체는 현재 페이지의 아이템 목록을 content 속성으로 가지고 있습니다.
      -->
      <article class="item-card" th:each="item : ${page.content}">
        <a th:href="@{/items/{itemId}(itemId=${item.id})}">
          <div class="item-image">
            <img th:src="@{${item.imageUrl}}" th:alt="${item.title}" alt="상품 이미지">
          </div>
          <div class="item-info">
            <h3 class="item-title" th:text="${item.title}">위닉스 제습기</h3>
            <!-- 수정: |...| 대신 + 연산자 사용 -->
            <p class="item-price" th:text="${#numbers.formatInteger(item.price, 3, 'COMMA')} + '원'">50,000원</p>
            <p class="item-location" th:text="${item.location}">인천 부평구 부평동</p>
            <!-- 수정: |...| 대신 + 연산자 사용 -->
            <p class="item-stats" th:text="'조회 ' + ${item.viewCount} + ' · 채팅 ' + ${item.chatCount}">조회 15 · 채팅 41</p>
          </div>
        </a>
      </article>
    </div>

    <!-- 검색 결과가 없을 경우 메시지 표시 (수정: |...| 대신 + 연산자 사용) -->
    <div class="no-results" th:if="${page.empty}">
      <p th:text="'\'' + ${query} + '\'에 대한 검색 결과가 없습니다.'"></p>
    </div>

    <!--pagenation-->
    <nav class="pagination" th:if="${!page.empty}">

      <!-- 이전 페이지 버튼: 첫 페이지일 때 'disabled' 클래스가 추가됨 -->
      <a th:href="${page.first} ? '#' : @{/search(query=${query}, page=${page.number - 1})}"
         th:classappend="${page.first} ? 'disabled'"
         class="page-arrow">
        <
      </a>

      <!-- 현재 페이지 / 전체 페이지 -->
      <span class="page-info" th:text="|${page.number + 1} / ${page.totalPages}|"></span>

      <!-- 다음 페이지 버튼: 마지막 페이지일 때 'disabled' 클래스가 추가됨 -->
      <a th:href="${page.last} ? '#' : @{/search(query=${query}, page=${page.number + 1})}"
         th:classappend="${page.last} ? 'disabled'"
         class="page-arrow">
        >
      </a>

    </nav>

  </div>
</main>

</body>
</html>